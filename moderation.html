<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moderation Panel - Ophthalmic Infographic Creator</title>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üëÅÔ∏è</text></svg>">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            overflow: auto;
            background: var(--bg-color);
        }
        
        .moderation-page {
            min-height: 100vh;
            padding: 2rem;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 1.5rem;
            transition: all 0.2s;
        }
        
        .back-link:hover {
            color: var(--primary-dark);
            transform: translateX(-4px);
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e2e8f0;
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 2000;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .toast.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .toast.info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }
        
        .empty-moderation {
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: 16px;
            border: 1px solid var(--border-color);
        }
        
        .empty-moderation .material-symbols-rounded {
            font-size: 4rem;
            color: var(--text-tertiary);
            opacity: 0.5;
            margin-bottom: 1rem;
        }
        
        .empty-moderation p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
    </style>
</head>

<body>
    <div class="moderation-page">
        <a href="index.html" class="back-link">
            <span class="material-symbols-rounded">arrow_back</span>
            Back to Infographic Creator
        </a>
        
        <div class="moderation-container">
            <div id="config-warning" class="community-info-banner" style="display: none; background: #fff7ed; border: 1px solid #ffedd5; color: #9a3412; margin-bottom: 1.5rem; padding: 1rem; border-radius: 12px; display: flex; align-items: flex-start; gap: 0.75rem;">
                <span class="material-symbols-rounded" style="color: #f97316;">warning</span>
                <div>
                    <strong style="display: block; margin-bottom: 0.25rem;">Remote Storage Not Configured</strong>
                    <p style="font-size: 0.9rem; line-height: 1.4; margin: 0;">
                        The system is currently running in <strong>Demo Mode (LocalStorage)</strong>. 
                        Submissions are only visible on your own device. To see submissions from remote users, you must 
                        configure JSONBin.io in <code>community-submissions.js</code>.
                    </p>
                </div>
            </div>

            <div class="moderation-header">
                <h1>
                    <span class="material-symbols-rounded">admin_panel_settings</span>
                    Moderation Panel
                    <button id="refresh-btn" onclick="refreshSubmissions()" style="margin-left: 1rem; padding: 0.5rem; border: none; background: transparent; cursor: pointer; vertical-align: middle;">
                        <span class="material-symbols-rounded" style="color: var(--primary-color);">refresh</span>
                    </button>
                </h1>
                <div class="admin-login">
                    <input type="password" id="admin-pin" placeholder="Admin PIN" maxlength="10">
                    <button id="verify-btn" class="btn-primary" style="padding: 0.6rem 1.25rem;">
                        <span class="material-symbols-rounded">lock_open</span>
                        Unlock
                    </button>
                    <div id="admin-status" class="admin-status locked">
                        <span class="material-symbols-rounded">lock</span>
                        Locked
                    </div>
                </div>
            </div>
            
            <!-- Stats Section -->
            <div class="moderation-stats">
                <div class="stat-card pending">
                    <div class="stat-icon">
                        <span class="material-symbols-rounded">pending</span>
                    </div>
                    <div class="stat-info">
                        <h3>Pending Review</h3>
                        <span class="stat-number" id="pending-stat">0</span>
                    </div>
                </div>
                <div class="stat-card approved">
                    <div class="stat-icon">
                        <span class="material-symbols-rounded">verified</span>
                    </div>
                    <div class="stat-info">
                        <h3>Approved</h3>
                        <span class="stat-number" id="approved-stat">0</span>
                    </div>
                </div>
                <div class="stat-card total">
                    <div class="stat-icon">
                        <span class="material-symbols-rounded">analytics</span>
                    </div>
                    <div class="stat-info">
                        <h3>Total Submissions</h3>
                        <span class="stat-number" id="total-stat">0</span>
                    </div>
                </div>
            </div>
            
            <!-- Pending Submissions Section -->
            <div class="moderation-section">
                <h2>
                    <span class="material-symbols-rounded">pending_actions</span>
                    Pending Submissions
                </h2>
                <div id="pending-list">
                    <!-- Pending submissions will be rendered here -->
                </div>
                <div id="pending-empty" class="empty-moderation" style="display: none;">
                    <span class="material-symbols-rounded">inbox</span>
                    <p>No pending submissions to review.</p>
                </div>
            </div>
            
            <!-- Approved Submissions Section -->
            <div class="moderation-section">
                <h2>
                    <span class="material-symbols-rounded">verified</span>
                    Approved Submissions
                </h2>
                <div id="approved-list">
                    <!-- Approved submissions will be rendered here -->
                </div>
                <div id="approved-empty" class="empty-moderation" style="display: none;">
                    <span class="material-symbols-rounded">folder_off</span>
                    <p>No approved submissions yet.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <span class="material-symbols-rounded" id="toast-icon">check_circle</span>
        <span id="toast-message">Action completed</span>
    </div>

    <script src="community-submissions.js"></script>
    <script>
        // DOM Elements
        const adminPinInput = document.getElementById('admin-pin');
        const verifyBtn = document.getElementById('verify-btn');
        const adminStatus = document.getElementById('admin-status');
        const pendingList = document.getElementById('pending-list');
        const approvedList = document.getElementById('approved-list');
        const pendingEmpty = document.getElementById('pending-empty');
        const approvedEmpty = document.getElementById('approved-empty');
        const pendingStat = document.getElementById('pending-stat');
        const approvedStat = document.getElementById('approved-stat');
        const totalStat = document.getElementById('total-stat');
        const loadingOverlay = document.getElementById('loading-overlay');
        const configWarning = document.getElementById('config-warning');
        const toast = document.getElementById('toast');
        const toastIcon = document.getElementById('toast-icon');
        const toastMessage = document.getElementById('toast-message');
        
        let isAdminVerified = false;
        let adminPIN = ''; // Store the verified PIN
        let currentSubmissions = { submissions: [], approved: [] };
        
        // Show loading overlay
        function showLoading() {
            loadingOverlay.style.display = 'flex';
        }
        
        // Hide loading overlay
        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }
        
        // Show toast notification
        function showToast(message, type = 'success') {
            toastMessage.textContent = message;
            toast.className = `toast ${type}`;
            
            if (type === 'success') {
                toastIcon.textContent = 'check_circle';
            } else if (type === 'error') {
                toastIcon.textContent = 'error';
            } else {
                toastIcon.textContent = 'info';
            }
            
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Format date
        function formatDate(isoString) {
            const date = new Date(isoString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Verify admin PIN
        verifyBtn.addEventListener('click', () => {
            const pin = adminPinInput.value;
            if (CommunitySubmissions.verifyAdmin(pin)) {
                isAdminVerified = true;
                adminPIN = pin; // Store the verified PIN for later use
                adminStatus.innerHTML = '<span class="material-symbols-rounded">lock_open</span> Unlocked';
                adminStatus.className = 'admin-status unlocked';
                verifyBtn.style.display = 'none';
                adminPinInput.style.display = 'none';
                showToast('Admin access granted!', 'success');
                renderSubmissions();
            } else {
                showToast('Invalid PIN. Access denied.', 'error');
                adminPinInput.value = '';
            }
        });
        
        // Handle enter key on PIN input
        adminPinInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                verifyBtn.click();
            }
        });
        
        // Render submission card
        function renderSubmissionCard(submission, isApprovedSection = false) {
            const dateStr = formatDate(submission.submittedAt);
            const approvedStr = submission.approvedAt ? formatDate(submission.approvedAt) : '';
            
            return `
                <div class="admin-card" data-id="${submission.id}">
                    <div class="admin-card-content">
                        <h3 class="admin-card-title">${submission.title}</h3>
                        <p class="admin-card-summary">${submission.summary || 'No summary provided.'}</p>
                        <div class="admin-card-meta">
                            <span>
                                <span class="meta-label">Author:</span> ${submission.userName}
                            </span>
                            <span>
                                <span class="meta-label">Submitted:</span> ${dateStr}
                            </span>
                            <span>
                                <span class="meta-label">IP:</span> 
                                <code style="background: #f1f5f9; padding: 0.1rem 0.4rem; border-radius: 4px; font-size: 0.8rem;">
                                    ${submission.userIP || 'Unknown'}
                                </code>
                            </span>
                            <span>
                                <span class="meta-label">Likes:</span> ${submission.likes || 0}
                            </span>
                            ${approvedStr ? `
                            <span>
                                <span class="meta-label">Approved:</span> ${approvedStr}
                            </span>
                            ` : ''}
                        </div>
                    </div>
                    <div class="admin-card-actions">
                        ${!isApprovedSection && isAdminVerified ? `
                        <button class="community-btn approve-btn" onclick="handleApprove('${submission.id}')">
                            <span class="material-symbols-rounded">check_circle</span>
                            Approve
                        </button>
                        <button class="community-btn reject-btn" onclick="handleReject('${submission.id}')">
                            <span class="material-symbols-rounded">cancel</span>
                            Reject
                        </button>
                        ` : ''}
                        <button class="community-btn preview-btn" onclick="handlePreview('${submission.id}')">
                            <span class="material-symbols-rounded">visibility</span>
                            Preview
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Render all submissions
        async function renderSubmissions() {
            showLoading();
            
            try {
                currentSubmissions = await CommunitySubmissions.getAll();
                
                const pending = currentSubmissions.submissions || [];
                const approved = currentSubmissions.approved || [];
                
                // Update stats
                pendingStat.textContent = pending.length;
                approvedStat.textContent = approved.length;
                totalStat.textContent = pending.length + approved.length;
                
                // Render pending
                if (pending.length > 0) {
                    pendingList.innerHTML = pending.map(s => renderSubmissionCard(s, false)).join('');
                    pendingEmpty.style.display = 'none';
                } else {
                    pendingList.innerHTML = '';
                    pendingEmpty.style.display = 'block';
                }
                
                // Render approved
                if (approved.length > 0) {
                    approvedList.innerHTML = approved.map(s => renderSubmissionCard(s, true)).join('');
                    approvedEmpty.style.display = 'none';
                } else {
                    approvedList.innerHTML = '';
                    approvedEmpty.style.display = 'block';
                }
            } catch (err) {
                console.error('Error loading submissions:', err);
                showToast('Error loading submissions. Please refresh.', 'error');
            } finally {
                hideLoading();
            }
        }
        
        // Handle approve
        window.handleApprove = async function(submissionId) {
            if (!isAdminVerified) {
                showToast('Please verify admin access first.', 'error');
                return;
            }
            
            if (!confirm('Approve this submission? It will become publicly visible in the gallery.')) {
                return;
            }
            
            showLoading();
            
            const result = await CommunitySubmissions.approve(submissionId, adminPIN);
            
            if (result.success) {
                showToast('Submission approved successfully!', 'success');
                await renderSubmissions();
            } else {
                showToast(result.message || 'Failed to approve.', 'error');
            }
            
            hideLoading();
        };
        
        // Handle reject
        window.handleReject = async function(submissionId) {
            if (!isAdminVerified) {
                showToast('Please verify admin access first.', 'error');
                return;
            }
            
            if (!confirm('Reject and remove this submission? This action cannot be undone.')) {
                return;
            }
            
            showLoading();
            
            const result = await CommunitySubmissions.reject(submissionId, adminPIN);
            
            if (result.success) {
                showToast('Submission rejected and removed.', 'success');
                await renderSubmissions();
            } else {
                showToast(result.message || 'Failed to reject.', 'error');
            }
            
            hideLoading();
        };
        
        // Handle preview - renders full graphical infographic
        window.handlePreview = function(submissionId) {
            // Find the submission
            let submission = (currentSubmissions.submissions || []).find(s => s.id === submissionId);
            if (!submission) {
                submission = (currentSubmissions.approved || []).find(s => s.id === submissionId);
            }
            
            if (!submission || !submission.data) {
                showToast('Could not load preview data.', 'error');
                return;
            }
            
            const data = submission.data;
            
            // Build full graphical preview
            const previewWindow = window.open('', '_blank');
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Preview: ${submission.title}</title>
                    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üëÅÔ∏è</text></svg>">
                    <link rel="preconnect" href="https://fonts.googleapis.com">
                    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
                    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
                    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
                    <link rel="stylesheet" href="style.css">
                    <style>
                        html {
                            height: 100%;
                            overflow-y: scroll;
                        }
                        body {
                            padding: 2rem;
                            padding-top: 100px;
                            padding-bottom: 4rem;
                            background: linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 100%);
                            min-height: 100%;
                            display: flex;
                            justify-content: center;
                            align-items: flex-start;
                            overflow-y: auto;
                        }
                        .preview-info {
                            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
                            color: white;
                            padding: 1rem 2rem;
                            position: fixed;
                            top: 0;
                            left: 0;
                            right: 0;
                            z-index: 100;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
                        }
                        .preview-info h2 {
                            margin: 0;
                            font-size: 1.1rem;
                            display: flex;
                            align-items: center;
                            gap: 0.5rem;
                        }
                        .preview-info span {
                            font-size: 0.9rem;
                            opacity: 0.8;
                        }
                        #output-container {
                            width: 100%;
                            max-width: 900px;
                        }
                        .poster-sheet {
                            max-width: 900px;
                            width: 100%;
                        }
                        .preview-badge {
                            background: #f59e0b;
                            color: #1e293b;
                            padding: 0.25rem 0.75rem;
                            border-radius: 20px;
                            font-size: 0.75rem;
                            font-weight: 600;
                            text-transform: uppercase;
                        }
                        /* Scroll indicator */
                        .scroll-hint {
                            position: fixed;
                            bottom: 20px;
                            right: 20px;
                            background: rgba(30, 41, 59, 0.9);
                            color: white;
                            padding: 0.5rem 1rem;
                            border-radius: 30px;
                            font-size: 0.85rem;
                            display: flex;
                            align-items: center;
                            gap: 0.5rem;
                            animation: bounce 2s infinite;
                            cursor: pointer;
                            z-index: 99;
                        }
                        .scroll-hint:hover {
                            background: rgba(30, 41, 59, 1);
                        }
                        @keyframes bounce {
                            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
                            40% { transform: translateY(-5px); }
                            60% { transform: translateY(-3px); }
                        }
                    </style>
                </head>
                <body>
                    <div class="preview-info">
                        <h2>
                            <span class="material-symbols-rounded">preview</span>
                            ${submission.title}
                            <span class="preview-badge">Preview</span>
                        </h2>
                        <span>By ${submission.userName} | ${formatDate(submission.submittedAt)}</span>
                    </div>
                    <div id="output-container" class="output-wrapper"></div>
                    <div class="scroll-hint" onclick="window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'}); this.style.display='none';">
                        <span class="material-symbols-rounded">keyboard_double_arrow_down</span>
                        Scroll to see more
                    </div>
                    <script>
                        const data = ${JSON.stringify(data)};
                        
                        function renderInfographic(data) {
                            const outputContainer = document.getElementById('output-container');
                            outputContainer.innerHTML = '';

                            const posterSheet = document.createElement('div');
                            posterSheet.className = 'poster-sheet';

                            // Header
                            const header = document.createElement('header');
                            header.className = 'poster-header';
                            
                            let illustrationHtml = '';
                            if (data.summary_illustration) {
                                illustrationHtml = '<div class="poster-illustration">' + data.summary_illustration + '</div>';
                            }

                            header.innerHTML = 
                                '<div class="header-decoration"></div>' +
                                '<h1 class="poster-title">' + data.title + '</h1>' +
                                '<div class="header-content-wrapper" style="display: flex; gap: 2rem; align-items: start;">' +
                                    '<p class="poster-summary" style="flex: 1;">' + data.summary + '</p>' +
                                    illustrationHtml +
                                '</div>';
                            posterSheet.appendChild(header);

                            // Grid
                            const grid = document.createElement('div');
                            grid.className = 'poster-grid';

                            if (data.sections && Array.isArray(data.sections)) {
                                data.sections.forEach((section, index) => {
                                    const card = document.createElement('div');
                                    const layoutClass = section.layout === 'full_width' ? 'col-span-2' : '';
                                    const colorClass = 'theme-' + (section.color_theme || 'blue');
                                    card.className = 'poster-card card-' + section.type + ' ' + layoutClass + ' ' + colorClass;
                                    card.style.animationDelay = (index * 100) + 'ms';

                                    const iconName = section.icon || 'circle';
                                    let contentHtml = '';

                                    switch (section.type) {
                                        case 'red_flag':
                                            const flags = Array.isArray(section.content) ? section.content : [section.content];
                                            contentHtml = '<ul class="warning-list">' +
                                                flags.map(item => '<li><span class="material-symbols-rounded warning-icon">warning</span>' + item + '</li>').join('') +
                                                '</ul>';
                                            break;

                                        case 'chart':
                                            const chartContent = section.content || {};
                                            const chartData = chartContent.data || [];
                                            contentHtml = '<div class="bar-chart">' +
                                                chartData.map(d => 
                                                    '<div class="chart-row">' +
                                                        '<div class="chart-label">' + d.label + '</div>' +
                                                        '<div class="chart-bar-container">' +
                                                            '<div class="chart-bar" style="width: ' + d.value + '%"></div>' +
                                                            '<span class="chart-val">' + d.value + '%</span>' +
                                                        '</div>' +
                                                    '</div>'
                                                ).join('') +
                                                '</div>';
                                            break;

                                        case 'remember':
                                            const mem = section.content || {};
                                            contentHtml = '<div class="mnemonic-box">' +
                                                '<div class="mnemonic-title">' + (mem.mnemonic || 'REMEMBER') + '</div>' +
                                                '<div class="mnemonic-text">' + mem.explanation + '</div>' +
                                                '</div>';
                                            break;

                                        case 'mindmap':
                                            const map = section.content || {};
                                            const branches = map.branches || [];
                                            contentHtml = '<div class="mindmap-container">' +
                                                '<div class="mindmap-center">' + map.center + '</div>' +
                                                '<div class="mindmap-branches">' +
                                                    branches.map(b => '<div class="mindmap-branch">' + b + '</div>').join('') +
                                                '</div>' +
                                                '</div>';
                                            break;

                                        case 'key_point':
                                        case 'process':
                                            const points = Array.isArray(section.content) ? section.content : [section.content];
                                            contentHtml = '<ul class="card-list">' +
                                                points.map(item => '<li>' + item + '</li>').join('') +
                                                '</ul>';
                                            break;

                                        case 'table':
                                            if (section.content && section.content.headers && section.content.rows) {
                                                const headers = section.content.headers || [];
                                                const rows = section.content.rows || [];
                                                contentHtml = '<div class="table-wrapper"><table class="data-table">' +
                                                    '<thead><tr>' + headers.map(h => '<th>' + h + '</th>').join('') + '</tr></thead>' +
                                                    '<tbody>' + rows.map(row => '<tr>' + row.map(cell => '<td>' + cell + '</td>').join('') + '</tr>').join('') + '</tbody>' +
                                                    '</table></div>';
                                            } else {
                                                contentHtml = '<p class="plain-text">Invalid table data.</p>';
                                            }
                                            break;

                                        default:
                                            contentHtml = '<p class="plain-text">' + section.content + '</p>';
                                    }

                                    card.innerHTML = 
                                        '<h3 class="card-title">' +
                                            '<div class="icon-box"><span class="material-symbols-rounded">' + iconName + '</span></div>' +
                                            section.title +
                                        '</h3>' +
                                        '<div class="card-content">' + contentHtml + '</div>' +
                                        '<div class="card-deco"></div>';
                                    
                                    grid.appendChild(card);
                                });
                            }

                            posterSheet.appendChild(grid);
                            outputContainer.appendChild(posterSheet);
                        }
                        
                        renderInfographic(data);
                        
                        // Hide scroll hint when user scrolls or if content is short
                        const scrollHint = document.querySelector('.scroll-hint');
                        window.addEventListener('scroll', function() {
                            if (scrollHint) scrollHint.style.display = 'none';
                        });
                        // Hide if content fits in viewport
                        setTimeout(function() {
                            if (document.body.scrollHeight <= window.innerHeight + 100) {
                                if (scrollHint) scrollHint.style.display = 'none';
                            }
                        }, 500);
                    <\/script>
                </body>
                </html>
            `);
            previewWindow.document.close();
        };
        
        // Refresh function - clears cache and reloads
        window.refreshSubmissions = async function() {
            // Clear cache to force fresh data
            localStorage.removeItem('ophthalmic_community_cache');
            showToast('Refreshing submissions...', 'info');
            await renderSubmissions();
        };
        
        // Initial load - clear cache to ensure fresh data
        localStorage.removeItem('ophthalmic_community_cache');
        
        // Check configuration status
        if (!CommunitySubmissions.isConfigured()) {
            configWarning.style.display = 'flex';
        } else {
            configWarning.style.display = 'none';
        }
        
        renderSubmissions();
    </script>
</body>

</html>
